<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Dashboard{% endblock %}</title>



  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Soft UI Design System CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/soft-design-system.min.css') }}">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/sidebar.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>

  

  <!-- Sidebar -->
  {% include "_sidebar.html" %}

  <!-- Page-specific content -->
  <main class="main-content bg-gradient-light">
    {% block content %}{% endblock %}
  </main>

  <!-- Shared session modal -->
  <div class="modal fade" id="sessionModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg modal-dialog-scrollable">
      <div class="modal-content session-modal rounded-4 border-0 shadow-lg">
        <div class="modal-body p-0">

          <!-- HERO -->
          <div class="session-hero position-relative rounded-top-4 p-3 p-md-4">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <div class="session-time" id="mTime"></div>
                <div class="session-room text-secondary" id="mRoom"></div>
              </div>
            </div>
            <div class="d-flex gap-3 align-items-center mt-3">
              <img id="mImg" src="" alt="" class="rounded-3 d-none d-md-block session-thumb">
              <div class="flex-grow-1">
                <h5 class="mb-1 session-title" id="mTitle"></h5>
                <div class="text-secondary session-authors" id="mAuthors"></div>
              </div>
            </div>
          </div>


          <!-- BODY -->
          <div class="p-4 session-body">
            <p><strong>Subject:</strong> <span id="mSubject"></span></p>
            <p><strong>Type:</strong> <span id="mType"></span></p>
            <p><strong>Presenters:</strong> <span id="mPresenters"></span></p>
            <p class="mb-0 session-abstract" id="mAbstract"></p>
          </div>

          <!-- FOOTER -->
          <div class="p-3 d-flex justify-content-end">
            <button class="btn btn-primary rounded-pill px-4">Rate</button>
          </div>

        </div>
      </div>
    </div>
  </div>

  <!-- Auth helper -->
  <script>
    (async function(){
      try {
        const resp = await fetch('/me', { credentials: 'same-origin' });
        if (!resp.ok) {
          document.getElementById('login-btn').style.display = '';
          document.getElementById('logout-btn').style.display = 'none';
          document.getElementById('user-name').textContent = '';
          const img = document.getElementById('user-pic');
          img.style.display = 'none';
          img.src = '';
          return;
        }
        const data = await resp.json();
        if (data && data.authenticated) {
          document.getElementById('login-btn').style.display = 'none';
          document.getElementById('logout-btn').style.display = '';
          document.getElementById('user-name').textContent = data.name || data.email || '';
          const img = document.getElementById('user-pic');
          if (data.picture) { img.src = data.picture; img.style.display = ''; }
          else { img.style.display = 'none'; img.src = ''; }
        } else {
          document.getElementById('login-btn').style.display = '';
          document.getElementById('logout-btn').style.display = 'none';
        }
      } catch (e) {
        console.error('auth helper error', e);
        document.getElementById('login-btn').style.display = '';
        document.getElementById('logout-btn').style.display = 'none';
      }
    })();
  </script>


  <!-- Core JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{{ url_for('static', filename='assets/js/soft-design-system.min.js') }}"></script>

  <!-- Shared session modal JS -->
  <script src="{{ url_for('static', filename='js/session-modal.js') }}"></script>

  <!-- Page-specific JS -->
  {% block scripts %}{% endblock %}
</body>
</html>
