<!-- templates/_sidebar.html -->
<aside id="sidenav-main">
  <div class="sidebar-header">
    <button id="toggleSidebar" class="btn btn-sm btn-outline-secondary" aria-controls="sidenav-main" aria-expanded="true" title="Toggle sidebar">
      <img class="icon-img" src="{{ url_for('static', filename='icons/sidebar.svg') }}" alt="" aria-hidden="true">
    </button>
  </div>

  <nav>
    {# AUTH AREA #}
  
    {# Show "Sign in with Google" ONLY if user is NOT authenticated #}
    {% if not is_authenticated %}
      <a id="login-btn" href="/google/login" class="btn btn-outline-primary mb-2 nav-link">
        <img class="icon-img" src="{{ url_for('static', filename='icons/google.svg') }}" alt="" aria-hidden="true">
        <span class="label">Sign in with Google</span>
      </a>
    {% endif %}
  
    {# Profile button:
      - If user is authenticated, in DB, and is presenter/organizer -> go to profile
      - Otherwise -> go to signup
   #}
   {% if is_authenticated and db_user and (is_presenter or is_organizer) %}
     {# Auth + has account + correct role -> profile #}
     <a id="profile-btn"
        class="btn btn-outline-secondary mb-4 nav-link card text-center border"
        href="{{ url_for('profile') }}">
       <span id="profile" class="text-uppercase label">CUSRR Profile</span>
       {% if user_picture %}
         <img id="user-pic" src="{{ user_picture }}" alt="User avatar" width="35" height="35">
       {% endif %}
       <span id="user-name" class="text-uppercase label">
         {{ user_name or '' }}
       </span>
     </a>
   {% else %}
     {# No DB account yet, or wrong role, or not authenticated -> send them to signup #}
     <a id="profile-btn"
        class="btn btn-outline-secondary mb-4 nav-link card text-center border"
        href="{{ url_for('signup') }}">
       <span id="profile" class="text-uppercase label">CUSRR Profile</span>
       <img id="user-pic" src="" alt="User avatar" width="35" height="35" style="display:none;">
       <span id="user-name" class="text-uppercase label"></span>
     </a>
   {% endif %}
   
    {# Show Logout ONLY if authenticated #}
    {% if is_authenticated %}
      <a id="logout-btn" href="/google/logout" class="btn btn-outline-secondary mb-4 nav-link">
        <img class="icon-img" src="{{ url_for('static', filename='icons/logout.svg') }}" alt="" aria-hidden="true">
        <span class="label">Logout</span>
      </a>
    {% endif %}
  
    <!-- Everyone can see these -->
    <div class="mt-3 mb-2 text-uppercase text-xs opacity-6" style="padding-left:6px;">All Users</div>
    <a class="btn btn-outline-secondary mb-2 nav-link" href="{{ url_for('dashboard') }}">
      <img class="icon-img" src="{{ url_for('static', filename='icons/dashboard.svg') }}" alt="" aria-hidden="true">
      <span class="label">Dashboard</span>
    </a>
    <a class="btn btn-outline-secondary mb-2 nav-link" href="{{ url_for('schedule') }}">
      <img class="icon-img" src="{{ url_for('static', filename='icons/schedule.svg') }}" alt="" aria-hidden="true">
      <span class="label">Schedule</span>
    </a>
  
    {# ONLY for abstract graders and organizers #}
    {% if 'abstract-grader' in roles or is_organizer %}
      <div id="abstractGrader">
        <div class="mt-3 mb-2 text-uppercase text-xs opacity-6" style="padding-left:6px;">Abstract Grader</div>
        <a class="btn btn-outline-secondary mb-2 nav-link" href="{{ url_for('abstractGrader') }}" rel="noopener">
          <img class="icon-img" src="{{ url_for('static', filename='icons/abstractGrading.svg') }}" alt="" aria-hidden="true">
          <span class="label">Abstract Grading</span>
        </a>
      </div>
    {% endif %}
  
    {# ONLY for organizers #}
    {% if is_organizer %}
      <div id="Organizer">
        <div class="mt-3 mb-2 text-uppercase text-xs opacity-6" style="padding-left:6px;">Organizer</div>
        <a class="btn btn-outline-secondary mb-2 nav-link" href="{{ url_for('organizer_user_status') }}">
          <img class="icon-img" src="{{ url_for('static', filename='icons/attendees.svg') }}" alt="" aria-hidden="true">
          <span class="label">Attendees</span>
        </a>
      </div>
    {% endif %}
  
  </nav>
  
</aside>

<script src="{{ url_for('static', filename='js/sidebar.js') }}"></script>
